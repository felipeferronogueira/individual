<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Climático e Internações — São Paulo</title>

  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      color: #222;
    }

    header {
      background: #004d40;
      color: white;
      padding: 18px 22px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 6px rgba(0, 0, 0, .2);
    }

    .container {
      max-width: 1200px;
      margin: auto;
      padding: 24px;
    }

    .info-local {
      text-align: center;
      font-size: 0.95rem;
      color: #444;
      margin-bottom: 25px;
    }

    /* KPIs */
    .linha-kpi {
      display: flex;
      justify-content: center;
      align-items: stretch;
      gap: 20px;
      margin-bottom: 25px;
    }

    .kpi {
      background: white;
      padding: 20px;
      border-radius: 10px;
      flex: 1;
      box-shadow: 0 2px 8px rgba(0, 0, 0, .1);
      text-align: center;
      transition: all .3s ease;
      min-height: 130px;
    }

    .kpi h3 {
      margin: 0;
      font-size: 1rem;
      color: #555;
      font-weight: 600;
    }

    .kpi p {
      margin-top: 10px;
      font-size: 1.5rem;
      font-weight: bold;
    }

    /* KPI de Alerta */
    .kpi.alerta {
      background: #b91c1c;
      border: 2px solid #7f1d1d;
      color: #fff;
      box-shadow: 0 0 10px rgba(185, 28, 28, 0.35);
    }

    .kpi.alerta h3 {
      color: #fff;
      margin-bottom: 6px;
    }

    .kpi.alerta p {
      color: #fff;
      font-size: 1.8rem;
    }

    /* Gráficos */
    .subtitulo {
      text-align: center;
      color: #333;
      font-weight: 600;
      margin: 10px 0 20px;
      font-size: 1rem;
    }

    .grade-graficos {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
    }

    .card-grafico {
      background: white;
      padding: 18px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, .1);
      min-height: 320px;
    }

    .legenda {
      text-align: center;
      margin-top: 10px;
      font-size: 0.9rem;
      color: #b91c1c;
      font-weight: bold;
    }

    .botao {
      background: #00bfa5;
      color: #003b34;
      border: none;
      padding: 10px 14px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .5);
      z-index: 999;
    }

    .conteudo-modal {
      background: white;
      width: 90%;
      max-width: 800px;
      margin: 5% auto;
      padding: 20px;
      border-radius: 10px;
    }

    .fechar {
      float: right;
      cursor: pointer;
      font-size: 22px;
      font-weight: bold;
    }
  </style>
</head>

<body>

  <header>
    <h2>Dashboard Climático e Internações — SP</h2>
    <button id="botaoAbrir" class="botao">Explicação Científica</button>
  </header>

  <div class="container">

    <div class="info-local">
      Monitoramento climático e hospitalar da cidade de <b>São Paulo (SP)</b>.
    </div>

    <!-- KPIs -->
    <div class="linha-kpi">
      <div id="boxRisco" class="kpi alerta">
        <h3>Nível de Risco Atual</h3>
        <p id="kpiRisco">--</p>
      </div>
      <div id="boxBalanceamento" class="kpi">
        <h3>Recomendação Operacional</h3>
        <p id="kpiBalanceamento">--</p>
      </div>
    </div>

    <div class="subtitulo">
      Relação entre umidade e internações respiratórias — picos com 3 meses de defasagem
    </div>

    <!-- Gráficos -->
    <div class="grade-graficos">
      <div class="card-grafico">
        <h4>Umidade Mensal (%)</h4>
        <div id="graficoUmidade"></div>
        <div id="legendaUmidade" class="legenda"></div>
      </div>

      <div class="card-grafico">
        <h4>Internações Mensais</h4>
        <div id="graficoInternacoes"></div>
        <div id="legendaInternacoes" class="legenda"></div>
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modalExplicacao" class="modal">
    <div class="conteudo-modal">
      <span id="btnFechar" class="fechar">&times;</span>
      <h2>Explicação Científica</h2>

      <p><b>Resumo:</b> Ambientes úmidos favorecem vírus e alérgenos, resultando em aumento de internações cerca de 3
        meses depois.</p>
      <p><b>Períodos secos:</b> Reduzem contágio, mas pioram doenças respiratórias já existentes.</p>
      <p>Conclusão: o acompanhamento climático permite prever a pressão hospitalar e otimizar recursos.</p>
    </div>
  </div>

  <!-- ApexCharts -->
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

  <script>
    const meses = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];

    const dadosUmidade = [72, 75, 78, 82, 83, 84, 85, 94, 80, 76, 74, 73];
    const dadosInternacoes = [300, 320, 330, 350, 420, 480, 500, 520, 540, 550, 700, 600];

    // KPI Textos corporativos
    const riscoTexto = `<b>ALTO</b><br>Umidade elevada registrada em Ago/Set<br>Demanda hospitalar crescente desde Out`;
    const balanceamentoTexto = `Reforçar ventiladores e equipe nas unidades de UTI<br>entre Nov–Dez`;

    // Inserir textos
    document.getElementById("kpiRisco").innerHTML = riscoTexto;
    document.getElementById("kpiBalanceamento").innerHTML = balanceamentoTexto;

    // --- Destaques manuais ---
    const mesDestaqueUmidade = 'Ago';
    const mesDestaqueInternacoes = 'Nov';

    const coresUmidade = meses.map(m => m === mesDestaqueUmidade ? '#b91c1c' : '#1e88e5');
    const coresInternacoes = meses.map(m => m === mesDestaqueInternacoes ? '#b91c1c' : '#1e88e5');

    document.getElementById("legendaUmidade").innerText = "Pico do período: Agosto";
    document.getElementById("legendaInternacoes").innerText = "Pico do período: Novembro";

    // --- Gráficos ---
    new ApexCharts(document.querySelector("#graficoUmidade"), {
      chart: { type: "bar" },
      series: [{ name: "Umidade (%)", data: dadosUmidade }],
      xaxis: {
        categories: meses,
        labels: { show: true },    // mantém "Jan, Fev..." embaixo
        axisBorder: { show: true },
        axisTicks: { show: true }
      },
      yaxis: { labels: { show: true } }, // mantém eixo Y se quiser
      dataLabels: {
        enabled: true,               // mostra número sobre cada barra
        style: { fontSize: '12px' }
      },
      grid: { show: false },
      colors: coresUmidade,          // mantém cores por barra (ex.: agosto vermelho)
      plotOptions: {
        bar: { distributed: true, borderRadius: 4, columnWidth: "60%" }
      },
      legend: { show: false },       // <- remove a bolinha + texto (legenda)
      tooltip: { enabled: true }
    }).render();

    // Gráfico Internações (sem legenda, com rótulos abaixo e números nas barras)
    new ApexCharts(document.querySelector("#graficoInternacoes"), {
      chart: { type: "bar" },
      series: [{ name: "Internações", data: dadosInternacoes }],
      xaxis: {
        categories: meses,
        labels: { show: true },    // mantém "Jan, Fev..." embaixo
        axisBorder: { show: true },
        axisTicks: { show: true }
      },
      yaxis: { labels: { show: true } },
      dataLabels: {
        enabled: true,               // mostra número sobre cada barra
        style: { fontSize: '12px' }
      },
      grid: { show: false },
      colors: coresInternacoes,     // mantém cores por barra (ex.: novembro vermelho)
      plotOptions: {
        bar: { distributed: true, borderRadius: 4, columnWidth: "60%" }
      },
      legend: { show: false },      // <- remove a bolinha + texto (legenda)
      tooltip: { enabled: true }
    }).render();


    // Modal
    const modal = document.getElementById("modalExplicacao");
    document.getElementById("botaoAbrir").onclick = () => modal.style.display = "block";
    document.getElementById("btnFechar").onclick = () => modal.style.display = "none";
    window.onclick = e => { if (e.target === modal) modal.style.display = "none" }
  </script>

</body>

</html>